##第一章 好的推荐体统
### 1.1 什么是推荐系统
- 以决定看什么电影为例
    - 向朋友咨询
    - 直接搜索喜欢的演员名
    - 查看top榜
### 1.2 个性化推荐系统的应用
- 1.2.1 电子商务
    - 推荐结果的标题、缩略图以及其他内容属性
    - 推荐结果的平均分
    - 推荐理由
- 1.2.2 电影和视频网站
    - 电影的标题和海报
    - 用户反馈模块
    - 推荐理由
- 1.2.3 个性化音乐网络电台
    - 物品空间大
    - 消费每首歌的代价很小
    - 物品种类丰富
    - 听一首歌耗时很少
    - 物品重用率很高
    - 用户充满激情
    - 上下文相关
    - 次序很重要
    - 很多播放列表资源
    - 不需要用户全神贯注
    - 高度社会化
- 1.2.4 社交网络
    - 利用用户的社交网络信息对用户进行个性化物品推荐
    - 信息流的会话推荐
    - 给用户推荐好友
- 1.2.5 个性化阅读
- 1.2.6 基于位置的服务
- 1.2.7 个性化邮件
- 1.2.8 个性化广告
    - 上下文广告
    - 搜索广告
    - 个性化展示广告
### 1.3 推荐测评系统
- 预测太阳明天从东边升起是一种没有意义的预测
- 1.3.1 推荐系统实验方法
    1. 离线实验
        - 通过日志系统获得用户行为数据，并按照一定格式生成一个标准的数据集
        - 将数据集按照一定的规则分成训练集和测试集
        - 在训练集上训练用户兴趣模型，在测试集上进行预测
        - 通过事先定义的离线指标评测算法在测试集上的预测结果
    2. 用户调查
    3. 在线实验
        - AB测试是一种很常用的在线评测算法的实验方法 http://www.abtests.com/
        - 一般来说一个新的推荐算法最终上线，需要完成上面所说的3个实验
            - 通过离线证明他在很多离线指标上优于现有算法
            - 通过用户调查确定他的用户满意度不低于现有的算法
            - 通过在线的AB测试确定他在我们关心的指标上优于现有的算法
- 1.3.2 测评指标
    1. 用户满意度
    2. 预测精准度
        - 评分预测
            - 评分预测的预测准确度一般通过均方根误差（RMSE）和平均绝对误差（MAE）计算。
            - 假设我们用一个列表records存放用户评分数据，令records[i] = [u,i,rui,pui]，其
                中rui是用户u对物品i的实际评分，pui是算法预测出来的用户u对物品i的评分，那么下面的代
                码分别实现了RMSE和MAE的计算过程。
                
                    def RMSE(records):
                        return math.sqrt(\
                            sum([(rui - pui) * (rui - pui) for u,i,rui,pui in records])\
                            /float(len(records)))
                
                    def MAE(records):
                        return sum([abs(rui - pui) for u,i,rui,pui in records])\
                            /float(len(records))
        - TopN推荐
            - 网站在提供推荐服务时，一般是给用户一个个性化的推荐列表，这种推荐叫做TopN推荐。
                TopN推荐的预测准确率一般通过准确率(precision)/召回率(recall)
            - 下面的Python代码同时计算出了一个推荐算法的准确率和召回率：
            
                    def PrecisionRecall(test,N)
                        hit = 0
                        n_recall = 0
                        n_precision = 0
                        for user, items in test.items():
                            rank = Recommend(user, N)
                            hit += len(rank & items)
                            n_recall += len(items)
                            n_precision += N
                        return [hit / (1.0 * n_recall), hit / (1.0 * n_precision)]
                        
            - 有的时候，为了全面测评TopN推荐的准确率和召回率，一般会选取不同的推荐列表长度N，
                计算出一组准确率/召回率，然后画出准确率/召回率(precision/recall curve)
    3. 覆盖率
        - 覆盖率(coverage)描述一个推荐系统对物品长尾的发觉能力。覆盖率有不同的定义方法，
            最简单的定义为推荐体统能够推荐出来的物品占总物品集合的比例。
        - 可以通过研究五物品在推荐列表中的出现次数的分布描述系统挖掘长尾的能力。如果这么分布比
            较平，那么说明推荐系统的覆盖率较高，而如果这个分布较陡峭，说明推荐系统的覆盖率较低。
            在信息论和经济学中有两个著名的指标可以用来定义覆盖率。
            - 信息熵
            - 基尼系数(Gini Index)
            
                    def GiniIndex(p):
                        j = 1
                        n = len(p)
                        G = 0
                        for item,weight in sorted(p.items(), key = itemgetter(1)):
                            G += (2 * j - n - 1) * weight
                        return G / float(n - 1)
            
                - 可以测评推荐系统是都具有马太效应(即所谓强者更强，弱者更弱)
    4. 多样性
    5. 新颖性
    6. 惊喜度(serendipity)
    7. 信任度
    8. 实时性
    9. 健壮性
    10. 商业目标   

- 1.3.3 测评维度
    1. 用户维度  主要包括用户的人口统计学信息、活跃度以及是不是新用户等
    2. 物品维度  包括物品的属性信息、流行度、平均分以及是不是新加入的物品等
    3. 时间维度  包括季节，是工作日还是周末，是白天还是晚上等
    - 如果能在推荐系统测评中包含不同维度下的系统测评指标，就能帮我们全面的了解推
        荐系统性能，找到一个看上去比较弱的算法优势，发现一个看上去比较强的算法的缺点。    

## 第二章 利用用户行为数据
- 2.1 用户行为数据简介
    - 用户在个性化推荐系统中一般分两种——`显性反馈行为`(explicit feedback)和`隐形反馈
    行为`(implicit feedback)。
    
                                                 用户行为的统一表示
              ————————————————————————————————————————————————————————————————————————————————————
              user id           产生行为的用户的唯一标识
              item id           产生行为的对象的唯一标识
              behavior type     行为的种类(比如是购买还是浏览)
              context           产生行为的上下文，包括时间和地点等
              behavior weight   行为的权重(如果是观看饰品的行为，那么这个权重可能是观看时长；如果是打分行为
                                这个权重可以是分数)
              behavior content  行为的内容(如果是评论行为，那么就是评论的文本；如果是打标签的行为，就是标签) 
              ————————————————————————————————————————————————————————————————————————————————————    
            